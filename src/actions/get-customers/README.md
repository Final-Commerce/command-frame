# getCustomers

Retrieves a list of customers from the parent application's local database.

## Parameters

### `GetCustomersParams`

```typescript
interface GetCustomersParams {
    query?: {
        email?: string | { $regex?: string; $options?: string };
        firstName?: string | { $regex?: string; $options?: string };
        lastName?: string | { $regex?: string; $options?: string };
        phone?: string | { $regex?: string; $options?: string };
        tags?: string | { $in?: string[] };
        outletId?: string;
        [key: string]: any;
    };
    offset?: number;
    limit?: number;
}
```

#### `query` (optional)

A query object to filter customers. The actual supported query operators depend on the database implementation (MongoDB/mongoose vs LokiJS/IndexedDB).

#### `offset` (optional)

The number of customers to skip before starting to return results. Defaults to `0` if not provided.

#### `limit` (optional)

The maximum number of customers to return. Defaults to `100` if not provided.

**Note:** The handler automatically excludes deleted customers.

## Response

### `GetCustomersResponse`

```typescript
interface GetCustomersResponse {
    customers: any[];
    total?: number;
    timestamp: string;
}
```

#### `customers` (any[])

Array of customer objects matching the query. The actual structure may vary depending on the database implementation (MongoDB/mongoose vs LokiJS/IndexedDB). See the [Real Data Examples](#real-data-examples) section below for actual customer object structures.

#### `total` (number, optional)

Total number of customers matching the query (before pagination). This count includes all matching customers, not just those returned in the `customers` array (which is limited by the `limit` parameter).

#### `timestamp` (string)

ISO 8601 timestamp string (e.g., `"2024-01-01T00:00:00.000Z"`) indicating when the response was generated by the handler.

## Usage

```typescript
import { command } from '@final-commerce/command-frame';
```

## Usage Examples

### Basic Query

Get all customers (up to 100 by default):

```typescript
import { command } from '@final-commerce/command-frame';

const result = await command.getCustomers();
console.log(result.customers);
```

### Query with Pagination

Get customers with custom offset and limit:

```typescript
import { command } from '@final-commerce/command-frame';

// Get first 50 customers
const firstPage = await command.getCustomers({
    offset: 0,
    limit: 50
});

// Get next 50 customers
const secondPage = await command.getCustomers({
    offset: 50,
    limit: 50
});
```

### Query with Filtering and Pagination

Get customers matching a query with pagination:

```typescript
import { command } from '@final-commerce/command-frame';

const result = await command.getCustomers({
    query: {
        email: { $regex: '@gmail.com', $options: 'i' }
    },
    offset: 0,
    limit: 25
});
```

## Real Data Examples

### Example Response

```json
{
  "customers": [
    {
      "_id": "691df9c6c478bada1fb23cdd",
      "companyId": "691df9c4c478bada1fb23bff",
      "email": "michael.smith@gmail.com",
      "firstName": "Michael",
      "lastName": "Smith",
      "phone": "+1-415-555-1234",
      "tags": [],
      "fromOliver": false,
      "metadata": [],
      "notes": [],
      "billing": {
        "address1": "123 Main Street",
        "address2": "",
        "city": "San Francisco",
        "company": "",
        "country": "US",
        "firstName": "Michael",
        "lastName": "Smith",
        "postCode": "94105",
        "state": "CA"
      },
      "shipping": {
        "address1": "123 Main Street",
        "address2": "",
        "city": "San Francisco",
        "company": "",
        "country": "US",
        "firstName": "Michael",
        "lastName": "Smith",
        "postCode": "94105",
        "state": "CA"
      },
      "isDeleted": false,
      "createdAt": "2024-12-03T10:00:00.000Z",
      "updatedAt": "2024-07-26T19:12:03.104Z"
    }
  ],
  "total": 33,
  "timestamp": "2025-12-04T19:25:50.817Z"
}
```

### Example Customer Object

```json
{
  "_id": "691df9c6c478bada1fb23cdd",
  "companyId": "691df9c4c478bada1fb23bff",
  "email": "michael.smith@gmail.com",
  "firstName": "Michael",
  "lastName": "Smith",
  "phone": "+1-415-555-1234",
  "tags": [],
  "fromOliver": false,
  "metadata": [],
  "notes": [],
  "billing": {
    "address1": "123 Main Street",
    "address2": "",
    "city": "San Francisco",
    "company": "",
    "country": "US",
    "firstName": "Michael",
    "lastName": "Smith",
    "postCode": "94105",
    "state": "CA"
  },
  "shipping": {
    "address1": "123 Main Street",
    "address2": "",
    "city": "San Francisco",
    "company": "",
    "country": "US",
    "firstName": "Michael",
    "lastName": "Smith",
    "postCode": "94105",
    "state": "CA"
  },
  "isDeleted": false,
  "createdAt": "2024-12-03T10:00:00.000Z",
  "updatedAt": "2024-07-26T19:12:03.104Z"
}
```

## Customer Structure Reference

The customer structure may vary depending on the database implementation. The structure shown above is a reference based on the MongoDB schema. In practice, customer objects are returned as `any` to allow flexibility between different database implementations (MongoDB/mongoose vs LokiJS/IndexedDB).

Key fields that may be present:

- **Address fields**: `billing` and `shipping` typically contain address information with `address1`, `city`, `state`, `country`, `postCode`, etc.
- **Metadata**: Array of key-value pairs for custom data.
- **Notes**: Array of timestamped messages associated with the customer.
- **ID fields**: The ID field structure depends on the database (may be `id`, `_id`, or other formats).

## Error Handling

If the query fails or no customers are found, the handler returns an empty array:

```typescript
{
    customers: [],
    total: 0,
    timestamp: "2024-01-01T00:00:00.000Z"
}
```

## Notes

- Results are limited by the `limit` parameter (defaults to 100 if not provided)
- Use `offset` and `limit` for pagination
- Deleted customers (`isDeleted: true`) are automatically excluded

