# deleteCustomTableData

Deletes a specific record from a custom table in the parent application's local database.

## Parameters

### `DeleteCustomTableDataParams`

```typescript
interface DeleteCustomTableDataParams {
    tableName: string;
    rowId: string;
}
```

#### `tableName` (required)

The name of the custom table to delete data from.

#### `rowId` (required)

The unique identifier (`_id`) of the record to delete.

## Response

### `DeleteCustomTableDataResponse`

```typescript
interface DeleteCustomTableDataResponse {
    success: boolean;
    timestamp: string;
}
```

#### `success` (boolean)

Indicates whether the record was successfully deleted.

#### `timestamp` (string)

ISO 8601 timestamp string (e.g., `"2024-01-01T00:00:00.000Z"`) indicating when the response was generated by the handler.

## Usage

```typescript
import { command } from '@final-commerce/command-frame';
```

## Usage Examples

### Delete a Record

Delete a specific record from a custom table:

```typescript
import { command } from '@final-commerce/command-frame';

const result = await command.deleteCustomTableData({
    tableName: 'customer_preferences',
    rowId: '65a1b2c3d4e5f6g7h8i9j0k3'
});

if (result.success) {
    console.log('Record deleted successfully');
}
```

### Delete with Confirmation

Delete a record after user confirmation:

```typescript
import { command } from '@final-commerce/command-frame';

// First, show confirmation dialog
const confirmed = await command.showConfirmation({
    title: 'Delete Record',
    message: 'Are you sure you want to delete this record?',
    confirmText: 'Delete',
    cancelText: 'Cancel'
});

if (confirmed) {
    const result = await command.deleteCustomTableData({
        tableName: 'customer_preferences',
        rowId: '65a1b2c3d4e5f6g7h8i9j0k3'
    });
    
    if (result.success) {
        await command.showNotification({
            message: 'Record deleted successfully',
            type: 'success'
        });
    }
}
```

### Delete After Query

Find and delete specific records:

```typescript
import { command } from '@final-commerce/command-frame';

// First, find the records to delete
const dataResult = await command.getCustomTableData({
    tableName: 'customer_preferences',
    query: {
        customerId: '691df9c6c478bada1fb23d55',
        theme: 'dark'
    }
});

// Delete each matching record
for (const record of dataResult.data) {
    await command.deleteCustomTableData({
        tableName: 'customer_preferences',
        rowId: record._id
    });
}

console.log(`Deleted ${dataResult.data.length} records`);
```

### Safe Delete with Error Handling

Delete a record with proper error handling:

```typescript
import { command } from '@final-commerce/command-frame';

try {
    const result = await command.deleteCustomTableData({
        tableName: 'customer_preferences',
        rowId: '65a1b2c3d4e5f6g7h8i9j0k3'
    });
    
    if (result.success) {
        console.log('Record deleted successfully');
    }
} catch (error) {
    console.error('Failed to delete record:', error);
    
    await command.showNotification({
        message: 'Failed to delete record',
        type: 'error'
    });
}
```

### Bulk Delete

Delete multiple records:

```typescript
import { command } from '@final-commerce/command-frame';

const recordIdsToDelete = [
    '65a1b2c3d4e5f6g7h8i9j0k3',
    '65a1b2c3d4e5f6g7h8i9j0k4',
    '65a1b2c3d4e5f6g7h8i9j0k5'
];

const results = await Promise.all(
    recordIdsToDelete.map(rowId =>
        command.deleteCustomTableData({
            tableName: 'customer_preferences',
            rowId
        })
    )
);

const successCount = results.filter(r => r.success).length;
console.log(`Deleted ${successCount} of ${recordIdsToDelete.length} records`);
```

## Error Handling

If the delete operation fails, the handler will throw an error. Common error scenarios include:
- Invalid `tableName` (table does not exist)
- Invalid `rowId` (record does not exist)
- Database connection issues
- Permission errors

## Validation Rules

- `tableName` is required and must reference an existing custom table
- `rowId` is required and must reference an existing record in the specified table

## Real Data Examples

### Example Response (Success)

```json
{
  "success": true,
  "timestamp": "2024-01-15T12:00:00.000Z"
}
```

### Example Request

```json
{
  "tableName": "customer_preferences",
  "rowId": "65a1b2c3d4e5f6g7h8i9j0k3"
}
```

## Notes

- The deletion is permanent and cannot be undone
- The record is deleted from the local IndexedDB database (LokiJS)
- The deletion is synchronized with the central MongoDB database via station-sync
- Consider implementing a soft delete pattern (marking records as deleted) if you need the ability to restore deleted records
- Use `getCustomTableData` to verify the record exists before attempting to delete it
- Consider showing a confirmation dialog before deleting critical data

